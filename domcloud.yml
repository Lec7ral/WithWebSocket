# ===================================================================
# Domcloud Deployment Configuration for CollabSphere (Fully Automated)
# ===================================================================

source: https://github.com/Lec7ral/WithWebSocket.git

features:
  - go

addons:
  - postgresql

nginx:
  root: public_html/public
  passenger:
    enabled: "on"
    # AHORA, el comando de inicio es nuestro script de shell.
    app_start_command: ./start.sh

commands:
  # 1. Descarga y sincroniza las dependencias.
  - go mod tidy
  - go mod download

  # 2. Compila la aplicación Go en un binario llamado 'collabsphere'.
  - go build -o collabsphere ./cmd/collabsphere

vars:
  # ¡MUY IMPORTANTE! Debes establecer este valor de forma segura
  # a través del panel de Domcloud o usando la CLI.
  JWT_SECRET: "CHANGE_THIS_IN_THE_DOMCLOUD_UI_OR_CLI"

  # Nivel de Log para Producción.
  LOG_LEVEL: "info"