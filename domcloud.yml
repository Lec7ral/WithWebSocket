# ===================================================================
# Domcloud Deployment Configuration for CollabSphere (Final Automated Version)
# ===================================================================

source: https://github.com/Lec7ral/WithWebSocket.git

features:
  - go

nginx:
  root: public_html/public
  passenger:
    enabled: "on"
    # El comando de inicio es nuestro script de shell.
    app_start_command: ./start.sh

commands:
  # 1. Asegura que el script de arranque sea ejecutable.
  - chmod +x ./start.sh
  # 2. Compila la aplicación.
  - go mod tidy
  - go build -o collabsphere ./cmd/collabsphere

vars:
  # 1. URL de la Base de Datos.
  #    Usamos comillas simples (') para manejar de forma segura los
  #    caracteres especiales en la contraseña.
  DATABASE_URL: 'postgres://boarded:lN9j11+P+99m)frFCF@localhost:5432/boarded_db?sslmode=disable'

  # 2. Secreto para los JWT.
  #    ¡DEBES CAMBIAR ESTE VALOR POR UNO PROPIO Y MÁS SEGURO!
  JWT_SECRET: 'ChangeThisBeforeGoingLive_a9b8c7d6e5f4'

  # 3. Nivel de Log para Producción.
  LOG_LEVEL: 'info'
